---
platform: linux

caches:
  - path: $HOME/.gradle/
  - path: $HOME/.m2/repository

params:
  TERM: dumb

inputs:
  - name: resource-tutorial
outputs:
  - name: generatedAPK
image_resource:
  type: docker-image
  source:
    repository: darkgeat/android-studio-gitlab-ci
    tag: '2.0.0'
run:
  path: sh
  user: root
  args:
    - -c
    - |
      export build_root=$(pwd)
      cd resource-tutorial/
      ./gradlew assembleDebug --stacktrace -PdisablePreDex
      cp app/build/outputs/apk/debug/app-debug.apk ${build_root}/generatedAPK/app-debug.apk