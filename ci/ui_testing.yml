---
platform: linux

caches:
  - path: $HOME/.gradle/
  - path: $HOME/.m2/repository
  - path: $HOME/.android/sdk/cmdline-tools/bin

params:
  TERM: dumb

inputs:
  - name: pr
  - name: runScripts
outputs:
  - name: reports
  - name: generatedAPK
image_resource:
  type: docker-image
  source:
    repository: darkgeat/android-studio-gitlab-ci
    tag: '3.2.0'
run:
  path: sh
  user: root
  args:
    - -c
    - |
      cd pr/
      . /runScripts/emulator.sh
      ./gradlew connectedAndroidTest
      ls -la